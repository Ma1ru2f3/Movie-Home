<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™</title>
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; margin:0; padding:0; }
    header { background:#222; color:#fff; padding:15px; text-align:center; }
    nav { background:#444; display:flex; justify-content:center; padding:10px; }
    nav a { color:white; margin:0 15px; text-decoration:none; font-weight:bold; }
    .container { padding:20px; }
    .video { background:white; padding:15px; margin-bottom:15px; border-radius:10px; box-shadow:0 2px 5px rgba(0,0,0,0.1); position:relative; }
    .dots { position:absolute; top:10px; right:10px; cursor:pointer; }
    .dropdown { display:none; position:absolute; top:30px; right:10px; background:#fff; border:1px solid #ccc; border-radius:5px; }
    .dropdown button { display:block; width:100%; border:none; padding:5px; background:none; cursor:pointer; }
    .hidden { display:none; }
    #login-info { margin:10px 0; }
  </style>
</head>
<body>

<header>
  <h1>üé¨ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™</h1>
</header>

<nav>
  <a href="#" onclick="showSection('home')">Home</a>
  <a href="#" onclick="showSection('videos')">Videos</a>
  <a href="#" onclick="showSection('history')">History</a>
  <a href="#" onclick="showSection('profile')">Profile</a>
</nav>

<div class="container">

  <!-- Home -->
  <div id="home" class="section">
    <h2>‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ üéâ</h2>
    <p>‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶™‡¶®‡¶ø ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡¶§‡ßá ‡¶ì ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá‡¶®‡•§</p>
  </div>

  <!-- Videos -->
  <div id="videos" class="section hidden">
    <h2>üì∫ ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü</h2>
    <div id="video-list"></div>
  </div>

  <!-- History -->
  <div id="history" class="section hidden">
    <h2>‚è≥ Watch History</h2>
    <ul id="history-list"></ul>
  </div>

  <!-- Profile -->
  <div id="profile" class="section hidden">
    <h2>üë§ ‡¶™‡ßç‡¶∞‡ßã‡¶´‡¶æ‡¶á‡¶≤</h2>
    <div id="login-info"></div>
    <div id="g_id_onload"
         data-client_id="119036146469-3kdd5drvt8udga1qk028qbjqoaug0sfi.apps.googleusercontent.com"
         data-callback="handleLogin"></div>
    <div class="g_id_signin" data-type="standard"></div>
    <button onclick="logout()">Logout</button>

    <h3>‚ûï ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶® (Admin only)</h3>
    <input type="text" id="admin-code" placeholder="Admin Code"><br><br>
    <input type="text" id="video-title" placeholder="‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶ü‡¶æ‡¶á‡¶ü‡ßá‡¶≤"><br><br>
    <input type="text" id="video-link" placeholder="YouTube/Drive Embed Link"><br><br>
    <button onclick="addVideo()">Add Video</button>
  </div>

</div>

<script>
  let currentUser = null;
  let videos = [];
  let history = [];

  function showSection(id) {
    document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
  }

  function handleLogin(response) {
    const data = jwt_decode(response.credential);
    currentUser = data;
    document.getElementById("login-info").innerHTML = `
      <p><b>Logged in as:</b> ${data.name} (${data.email})</p>
    `;
  }

  function logout() {
    currentUser = null;
    document.getElementById("login-info").innerHTML = "<p>Logged out.</p>";
  }

  function addVideo() {
    const code = document.getElementById("admin-code").value;
    if(code !== "12345") { alert("‚ùå Wrong Admin Code!"); return; }
    const title = document.getElementById("video-title").value;
    const link = document.getElementById("video-link").value;
    if(!title || !link) { alert("Fill all fields"); return; }

    const id = Date.now();
    videos.push({id, title, link});
    renderVideos();
  }

  function renderVideos() {
    const list = document.getElementById("video-list");
    list.innerHTML = "";
    videos.forEach(v => {
      const div = document.createElement("div");
      div.className = "video";
      div.innerHTML = `
        <h3>${v.title}</h3>
        <iframe width="100%" height="315" src="${v.link}" frameborder="0" allowfullscreen></iframe>
        <div class="dots" onclick="toggleMenu(${v.id})">‚ãÆ</div>
        <div id="menu-${v.id}" class="dropdown">
          <button onclick="deleteVideo(${v.id})">Delete</button>
        </div>
      `;
      div.querySelector("iframe").addEventListener("click", ()=>addHistory(v));
      list.appendChild(div);
    });
  }

  function toggleMenu(id) {
    const menu = document.getElementById(`menu-${id}`);
    menu.style.display = (menu.style.display === "block") ? "none" : "block";
  }

  function deleteVideo(id) {
    const code = prompt("Enter Admin Code to Delete:");
    if(code !== "12345") { alert("‚ùå Wrong Code!"); return; }
    videos = videos.filter(v => v.id !== id);
    renderVideos();
  }

  function addHistory(video) {
    history.push(video.title);
    const list = document.getElementById("history-list");
    const li = document.createElement("li");
    li.textContent = video.title;
    list.appendChild(li);
  }

  // decode jwt
  function jwt_decode(token) {
    let base64Url = token.split('.')[1];
    let base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
    let jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
      return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
    }).join(''));
    return JSON.parse(jsonPayload);
  }
</script>

</body>
</html>