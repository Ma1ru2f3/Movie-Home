<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MovieBox Clone</title>
  <style>
    body { font-family: Arial, sans-serif; margin:0; padding:0; background:#111; color:#fff;}
    header { display:flex; justify-content:space-around; padding:10px; background:#222; position:sticky; top:0; z-index:100;}
    header button { background:#333; color:#fff; border:none; padding:10px 20px; cursor:pointer; border-radius:5px;}
    header button.active { background:#f90; color:#000;}
    #content { padding:20px;}
    .video-card { background:#222; margin:10px 0; padding:10px; border-radius:8px;}
    .video-card iframe { width:100%; height:200px; border:none; border-radius:8px;}
    .video-card h3 { margin:5px 0;}
    #admin-panel { background:#333; padding:10px; border-radius:8px; margin-top:20px;}
    input, select { padding:5px; margin:5px 0; width:100%; border-radius:5px; border:none;}
    button.upload-btn { background:#f90; color:#000; border:none; padding:10px; cursor:pointer; width:100%; margin-top:10px; border-radius:5px;}
  </style>
</head>
<body>

<header>
  <button id="homeBtn" class="active">Home</button>
  <button id="searchBtn">Search</button>
  <button id="fvrtBtn">Fvrt</button>
  <button id="profileBtn">Profile</button>
</header>

<div id="content">
  <div id="homeSection"></div>
  <div id="searchSection" style="display:none;">
    <input type="text" id="searchInput" placeholder="Search by title">
    <div id="searchResults"></div>
  </div>
  <div id="fvrtSection" style="display:none;">
    <div id="fvrtList">No favorites yet.</div>
  </div>
  <div id="profileSection" style="display:none;">
    <div id="adminLogin">
      <input type="text" id="adminUser" placeholder="Admin Username">
      <input type="password" id="adminPass" placeholder="Admin Password">
      <button id="loginBtn">Login</button>
    </div>
    <div id="adminPanel" style="display:none;">
      <h3>Upload Video</h3>
      <input type="text" id="videoTitle" placeholder="Video Title">
      <input type="text" id="videoCategory" placeholder="Category">
      <input type="text" id="videoLink" placeholder="Video URL (MP4 or iframe)">
      <button class="upload-btn" id="uploadVideoBtn">Upload Video</button>
      <h3>All Videos</h3>
      <div id="allVideos"></div>
    </div>
  </div>
</div>

<script>
const SHEETDB_API = "https://sheetdb.io/api/v1/3p5l2ilgzemvr"; // Your SheetDB API

// Elements
const homeBtn = document.getElementById('homeBtn');
const searchBtn = document.getElementById('searchBtn');
const fvrtBtn = document.getElementById('fvrtBtn');
const profileBtn = document.getElementById('profileBtn');

const homeSection = document.getElementById('homeSection');
const searchSection = document.getElementById('searchSection');
const searchInput = document.getElementById('searchInput');
const searchResults = document.getElementById('searchResults');
const fvrtSection = document.getElementById('fvrtSection');
const fvrtList = document.getElementById('fvrtList');
const profileSection = document.getElementById('profileSection');
const adminLogin = document.getElementById('adminLogin');
const adminPanel = document.getElementById('adminPanel');
const adminUser = document.getElementById('adminUser');
const adminPass = document.getElementById('adminPass');
const loginBtn = document.getElementById('loginBtn');
const videoTitle = document.getElementById('videoTitle');
const videoCategory = document.getElementById('videoCategory');
const videoLink = document.getElementById('videoLink');
const uploadVideoBtn = document.getElementById('uploadVideoBtn');
const allVideos = document.getElementById('allVideos');

// Navigation
function showSection(section) {
  homeSection.style.display = section==='home'?'block':'none';
  searchSection.style.display = section==='search'?'block':'none';
  fvrtSection.style.display = section==='fvrt'?'block':'none';
  profileSection.style.display = section==='profile'?'block':'none';
  
  homeBtn.classList.toggle('active', section==='home');
  searchBtn.classList.toggle('active', section==='search');
  fvrtBtn.classList.toggle('active', section==='fvrt');
  profileBtn.classList.toggle('active', section==='profile');
}

homeBtn.onclick = ()=>{ showSection('home'); loadHomeVideos(); }
searchBtn.onclick = ()=>{ showSection('search'); }
fvrtBtn.onclick = ()=>{ showSection('fvrt'); loadFvrtVideos(); }
profileBtn.onclick = ()=>{ showSection('profile'); }

// Load Videos
async function loadHomeVideos() {
  homeSection.innerHTML = "Loading...";
  try {
    const res = await fetch(SHEETDB_API);
    const data = await res.json();
    homeSection.innerHTML = "";
    data.forEach(v=>{
      const card = document.createElement('div');
      card.className = 'video-card';
      card.innerHTML = `<h3>${v.title} [${v.category}]</h3><iframe src="${v.Link}" allowfullscreen></iframe>`;
      homeSection.appendChild(card);
    });
  } catch(err) {
    homeSection.innerHTML = "Error loading videos.";
  }
}

// Search
searchInput.addEventListener('input', async ()=>{
  const query = searchInput.value.toLowerCase();
  if(!query){ searchResults.innerHTML=""; return; }
  const res = await fetch(SHEETDB_API);
  const data = await res.json();
  const results = data.filter(v=>v.title.toLowerCase().includes(query));
  searchResults.innerHTML = "";
  results.forEach(v=>{
    const card = document.createElement('div');
    card.className = 'video-card';
    card.innerHTML = `<h3>${v.title} [${v.category}]</h3><iframe src="${v.Link}" allowfullscreen></iframe>`;
    searchResults.appendChild(card);
  });
});

// Favorites (simple localStorage)
function loadFvrtVideos(){
  const fav = JSON.parse(localStorage.getItem('fvrtVideos')||"[]");
  fvrtList.innerHTML = fav.length? "": "No favorites yet.";
  fav.forEach(v=>{
    const card = document.createElement('div');
    card.className = 'video-card';
    card.innerHTML = `<h3>${v.title} [${v.category}]</h3><iframe src="${v.Link}" allowfullscreen></iframe>`;
    fvrtList.appendChild(card);
  });
}

// Admin login
const ADMIN_USER = "admin";
const ADMIN_PASS = "1234";
loginBtn.onclick = ()=>{
  if(adminUser.value===ADMIN_USER && adminPass.value===ADMIN_PASS){
    adminLogin.style.display='none';
    adminPanel.style.display='block';
    loadAllVideos();
  }else{
    alert("Invalid credentials");
  }
}

// Upload video
uploadVideoBtn.onclick = async ()=>{
  const title = videoTitle.value;
  const category = videoCategory.value;
  const Link = videoLink.value;
  if(!title||!Link) { alert("Title and Link required"); return; }
  try{
    const res = await fetch(SHEETDB_API, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ data:{ title, category, Link } })
    });
    const data = await res.json();
    alert("Video uploaded successfully!");
    videoTitle.value=""; videoCategory.value=""; videoLink.value="";
    loadAllVideos();
  }catch(err){ alert("Upload failed"); }
}

// Load all videos for admin
async function loadAllVideos(){
  allVideos.innerHTML = "Loading...";
  try{
    const res = await fetch(SHEETDB_API);
    const data = await res.json();
    allVideos.innerHTML = "";
    data.forEach(v=>{
      const card = document.createElement('div');
      card.className='video-card';
      card.innerHTML = `<h3>${v.title} [${v.category}]</h3><iframe src="${v.Link}" allowfullscreen></iframe>
        <button onclick='deleteVideo("${v._id}")'>Delete</button>`;
      allVideos.appendChild(card);
    });
  }catch(err){ allVideos.innerHTML="Error loading"; }
}

// Delete video
async function deleteVideo(id){
  if(!confirm("Are you sure?")) return